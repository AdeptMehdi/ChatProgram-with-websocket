# ุงูพูฺฉุดู ฺุช ุจโุฏุฑูฺฏ (Real-Time Chat Application)

ฺฉ ุฑุงูฺฉุงุฑ ฺุช ุณุงุฒูุงู ู ููุงุณโูพุฐุฑ ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏุฑูโุชุฑู ุชฺฉููููฺโูุง ุฏูุง ูุจ ุดุงูู **Node.js**ุ **Express**ุ **Socket.io** ู ูุฑูโูุฑฺฉ **Astro** ุทุฑุงุญ ู ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช. ุงู ูพุฑูฺู ุจุง ุชูุฑฺฉุฒ ุจุฑ ุงุตูู ูููุฏุณ ูุฑูโุงูุฒุงุฑุ ุฌุฏุงุณุงุฒ ูุณุฆููุชโูุง (Separation of Concerns) ู ุนููฺฉุฑุฏ ุจููู ุชูุณุนู ุงูุชู ุงุณุช.

---

## ๐ ูุนูุงุฑ ุณุณุชู (SOP Architecture)

ุงู ุงูพูฺฉุดู ุจุฑ ูพุงู ุชููพูููฺ **Service-Oriented Programming (SOP)** ุทุฑุงุญ ุดุฏู ุงุณุช. ุฏุฑ ุงู ูุนูุงุฑุ ูุฑ ุจุฎุด ุงุฒ ููุทู ุชุฌุงุฑ ุจุฑูุงูู ุจู ฺฉ "ุณุฑูุณ" ูุณุชูู ู ุฎูุฏูุฎุชุงุฑ ุชุจุฏู ุดุฏู ุงุณุช ฺฉู ูุณุฆููุช ูุดุฎุต ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.

### ูุงูโูุง ุณุฑูุณ (Service Layer)
*   **UserService**: ูุฏุฑุช ฺุฑุฎู ุญุงุช ฺฉุงุฑุจุฑุงูุ ุฐุฎุฑูโุณุงุฒ ูุถุนุช ุงุชุตุงูุงุช ู ูฺฏุงุดุช Socket ID ุจู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ.
*   **RoomService**: ูุฏุฑุช ููุทู ูุฑุจูุท ุจู ุงุชุงูโูุง ฺฏูุชฺฏูุ ุฌุฏุงุณุงุฒ ูุถุงูุง ู ฺฉูุชุฑู ุฏุณุชุฑุณ ฺฉุงุฑุจุฑุงู ุจู ุฏุงุฏูโูุง ูุฑ ุงุชุงู.
*   **MessageService**: ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ูุงูุจ ูพุงูโูุงุ ูุฏุฑุช ูพุงูโูุง ุณุณุชู ู ูพุฑุฏุงุฒุด ูุญุชูุง ุงุฑุณุงู.

### ูุฒุงุง ูุนูุงุฑ SOP ุฏุฑ ุงู ูพุฑูฺู
1.  **ุชุณุชโูพุฐุฑ ุจุงูุง (Testability)**: ูุฑ ุณุฑูุณ ุจู ุตูุฑุช ูุฌุฒุง ู ุจุฏูู ูุงุจุณุชฺฏ ุจู ุฒุฑุณุงุฎุช ุณูฺฉุช ูุงุจู ุชุณุช ุงุณุช.
2.  **ูฺฏูุฏุงุฑ ุขุณุงู (Maintainability)**: ุชุบุฑ ุฏุฑ ููุทู ูุฏุฑุช ฺฉุงุฑุจุฑุงู ุง ูพุงูโูุง ุชุงุซุฑ ุจุฑ ุณุงุฑ ุจุฎุดโูุง ุณุณุชู ูุฏุงุฑุฏ.
3.  **ุชูุณุนูโูพุฐุฑ (Scalability)**: ุงูฺฉุงู ุงุถุงูู ฺฉุฑุฏู ุณุฑูุณโูุง ุฌุฏุฏ (ูุงููุฏ ุณุฑูุณ ุฏุชุงุจุณ ุง ุงุญุฑุงุฒ ููุช) ุจู ุณุงุฏฺฏ ู ุจุฏูู ุชุบุฑ ุฏุฑ ุณุงุฎุชุงุฑ ุงุตู.

### ฒ. ุจุฎุด ูุฑุงูุชโุงูุฏ (Frontend Layer)
*   **Astro Framework**: ุงุณุชูุงุฏู ุงุฒ ฺฉุงููพูููุชโูุง ูุฏุฑู Astro ุจุฑุง ุณุงุฎุชุงุฑุฏู ุจููู UI.
*   **Encapsulated Scripts**: ุงุณฺฉุฑูพุชโูุง ุณูุช ฺฉูุงูุช ุจู ุทูุฑ ฺฉุงูู ุฏุฑ ุชฺฏโูุง `<script>` ฺฉูพุณูููโุณุงุฒ ุดุฏูโุงูุฏ ุชุง ุงุฒ ุชุฏุงุฎู ุจุง SSR ู ุงุดุงุก ุณุฑุงุณุฑ ูุงููุฏ `window` ุฌููฺฏุฑ ุดูุฏ.
*   **Modern CSS**: ุทุฑุงุญ ฺฉุงููุงู ูุงฺฉูุดโฺฏุฑุง (Responsive) ุจุง ุงุณุชูุงุฏู ุงุฒ CSS Grid ู Flexboxุ ุจู ููุฑุงู ุชู ูพุดโูุฑุถ ุญุงูุช ุชุงุฑฺฉ (Dark Mode).
*   **SweetAlert2**: ุงุณุชูุงุฏู ุงุฒ ููุฏุงูโูุง ุชุนุงูู ู ุฒุจุง ุจุฑุง ูุฏุฑุช ูุฑูุฏ ุจู ุณุณุชู ู ููุงุด ุฎุทุงูุง.

---

## ๐ ูฺฺฏโูุง ฺฉูุฏ (Key Features)

*   โ **ุงุฑุชุจุงุท ุจโุฏุฑูฺฏ (Real-time)**: ุงุฑุณุงู ู ุฏุฑุงูุช ูพุงูโูุง ุจุฏูู ุชุงุฎุฑ.
*   โ **ูุฏุฑุช ุงุชุงูโูุง (Rooms)**: ุงูฺฉุงู ุงุฌุงุฏ ู ูพูุณุชู ุจู ุงุชุงูโูุง ฺฏูุชฺฏู ูุฎุชูู.
*   โ **ูุดุงูฺฏุฑ ุชุงูพ (Typing Indicator)**: ููุงุด ูุถุนุช ุฏุฑ ุญุงู ุชุงูพ ฺฉุงุฑุจุฑุงู.
*   โ **ุงุนูุงูโูุง ุณุณุชู**: ุงุทูุงุนโุฑุณุงู ุฎูุฏฺฉุงุฑ ููฺฏุงู ูุฑูุฏ ุง ุฎุฑูุฌ ฺฉุงุฑุจุฑุงู.
*   โ **ุชุณุชโูุญูุฑ (Test-Driven)**: ุฏุงุฑุง ูุฌููุนู ุชุณุชโูุง ุฌุงูุน ุจุฑุง ุชุถูู ูพุงุฏุงุฑ ฺฉุฏ.
*   โ **ุทุฑุงุญ ูุฏุฑู ู ูุงฺฉูุดโฺฏุฑุง**: ุจูููโุดุฏู ุจุฑุง ุชูุงู ุฏุณุชฺฏุงูโูุง (ููุจุงูุ ุชุจูุช ู ุฏุณฺฉุชุงูพ).

---

## ๐ก ูุณุชูุฏุงุช ุฑูุฏุงุฏูุง ุณูฺฉุช (Socket Events)

| ุฑูุฏุงุฏ | ุฌูุช | ุชูุถุญุงุช | ุฏุงุฏู ุงุฑุณุงู |
| :--- | :--- | :--- | :--- |
| `join` | ฺฉูุงูุช โ ุณุฑูุฑ | ุฏุฑุฎูุงุณุช ุจุฑุง ูพูุณุชู ุจู ฺฉ ุงุชุงู | `{ username, room }` |
| `message` | ุณุฑูุฑ โ ฺฉูุงูุช | ุฏุฑุงูุช ูพุงู ุฌุฏุฏ (ุณุณุชู ุง ฺฉุงุฑุจุฑ) | `{ user, text, timestamp }` |
| `sendMessage` | ฺฉูุงูุช โ ุณุฑูุฑ | ุงุฑุณุงู ูพุงู ูุชู ุจู ุงุชุงู | `string` |
| `typing` | ฺฉูุงูุช โ ุณุฑูุฑ | ุงุนูุงู ูุถุนุช ุชุงูพ ฺฉุงุฑุจุฑ | `boolean` |
| `userTyping` | ุณุฑูุฑ โ ฺฉูุงูุช | ุงุทูุงุนโุฑุณุงู ุชุงูพ ุจู ุณุงุฑ ฺฉุงุฑุจุฑุงู | `{ username, isTyping }` |
| `roomData` | ุณุฑูุฑ โ ฺฉูุงูุช | ุจุฑูุฒุฑุณุงู ูุณุช ฺฉุงุฑุจุฑุงู ุขููุงู ุงุชุงู | `{ room, users: [] }` |

---

## ๐ ูุตุจ ู ุฑุงูโุงูุฏุงุฒ (Setup & Installation)

### ูพุดโูุงุฒูุง
*   Node.js (ูุณุฎู ฑธ ุง ุจุงูุงุชุฑ)
*   npm ุง yarn

### ูุฑุงุญู ูุตุจ
ฑ. ูุฎุฒู ุฑุง ฺฉููู ฺฉูุฏ.
ฒ. ูุงุจุณุชฺฏโูุง ุฑุง ูุตุจ ฺฉูุฏ:
```bash
npm install
```

### ุงุฌุฑุง ูพุฑูฺู
ูพุฑูฺู ุดุงูู ุฏู ุจุฎุด ูุฑุงูุชโุงูุฏ ู ุจฺฉโุงูุฏ ุงุณุช:

ฑ. **ุงุฌุฑุง ุณุฑูุฑ ุจฺฉโุงูุฏ**:
```bash
npm start
```
ุณุฑูุฑ ุฑู ูพูุฑุช `4000` ุงุฌุฑุง ุฎูุงูุฏ ุดุฏ.

ฒ. **ุงุฌุฑุง ูุญุท ุชูุณุนู ูุฑุงูุชโุงูุฏ (Astro)**:
```bash
npm run dev
```
ุฑุงุจุท ฺฉุงุฑุจุฑ ุฏุฑ ุขุฏุฑุณ `http://localhost:3000` ุฏุฑ ุฏุณุชุฑุณ ุฎูุงูุฏ ุจูุฏ.

---

## ๐งช ุชุณุช ู ุชุถูู ฺฉูุช (Testing)

ุงู ูพุฑูฺู ุงุฒ **Jest** ุจุฑุง ุชุณุชโูุง ูุงุญุฏ (Unit Tests) ู ุงุฒ **Supertest** ุจุฑุง ุชุณุชโูุง ฺฉูพุงุฑฺูโุณุงุฒ ุณูฺฉุช ุงุณุชูุงุฏู ูโฺฉูุฏ.

ุจุฑุง ุงุฌุฑุง ุชุณุชโูุง:
```bash
npm test
```

---

## ๐ ุณุงุฎุชุงุฑ ุฏุฑุฎุช ูพุฑูฺู (Project Structure)

```text
.
โโโ __tests__/              # ุชุณุชโูุง ูุงุญุฏ ู ฺฉูพุงุฑฺูโุณุงุฒ
โ   โโโ socket.test.js      # ุชุณุช ุฑูุฏุงุฏูุง ุณูฺฉุช
โ   โโโ userManager.test.js # ุชุณุช ููุทู ูุฏุฑุช ฺฉุงุฑุจุฑุงู
โโโ public/
โ   โโโ css/
โ       โโโ style.css       # ุงุณุชุงูโูุง ุณุฑุงุณุฑ (Dark Mode)
โโโ src/
โ   โโโ components/
โ   โ   โโโ Chat.astro      # ฺฉุงููพูููุช ุงุตู ฺุช ู ููุทู ฺฉูุงูุช
โ   โโโ layouts/
โ   โ   โโโ Layout.astro    # ูุงูุจ ุงุตู HTML
โ   โโโ pages/
โ   โ   โโโ index.astro     # ุตูุญู ูุฑูุฏ ุงูพูฺฉุดู
โ   โโโ server/
โ       โโโ index.js        # ููุทู ูุฑูุฏ ุณุฑูุฑ Express
โ       โโโ socket.js       # ูุฏุฑุช ุฑูุฏุงุฏูุง Socket.io
โ       โโโ userManager.js  # ูุฏุฑุช ูุถุนุช ฺฉุงุฑุจุฑุงู ุฏุฑ ุญุงูุธู
โโโ astro.config.mjs        # ูพฺฉุฑุจูุฏ Astro
โโโ package.json            # ูุฏุฑุช ูุงุจุณุชฺฏโูุง ู ุงุณฺฉุฑูพุชโูุง
โโโ .gitignore              # ูุงูโูุง ูุงุฏุฏู ฺฏุฑูุชู ุดุฏู ุฏุฑ ฺฏุช
โโโ README.md               # ูุณุชูุฏุงุช ูพุฑูฺู
```

---

## ๐จโ๐ป ุชูุณุนูโุฏููุฏู
ุงู ูพุฑูฺู ุจุง ุฑุนุงุช ุงุณุชุงูุฏุงุฑุฏูุง ูููุฏุณ ูุฑูโุงูุฒุงุฑ ู ุจุง ูุฏู ุงุฑุงุฆู ฺฉ ููููู ฺฉุงูู ุงุฒ ูพุงุฏูโุณุงุฒ WebSockets ุฏุฑ ุงฺฉูุณุณุชู ูุฏุฑู JavaScript ุชูุณุนู ุงูุชู ุงุณุช.
